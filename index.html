<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wallpaper E-Perpus</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes slow-zoom { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        .bg-animate { animation: slow-zoom 20s infinite ease-in-out; }
        .glass { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
    </style>
</head>
<body class="bg-slate-900 min-h-screen overflow-hidden text-white cursor-pointer" onclick="location.href='menu-perpus.html'">
    <div class="fixed inset-0 z-0">
        <img src="https://images.unsplash.com/photo-1507842217343-583bb7270b66?q=80&w=2000" class="w-full h-full object-cover opacity-40 bg-animate">
        <div class="absolute inset-0 bg-gradient-to-t from-slate-900 via-transparent to-slate-900"></div>
    </div>
    <div class="relative z-10 flex flex-col items-center justify-between min-h-screen p-8 pb-16">
        <div class="text-center mt-10">
            <h2 id="clock" class="text-6xl font-black tracking-tighter">00:00</h2>
            <p id="date" class="text-xs font-bold uppercase tracking-[0.4em] opacity-70">Memuat Tanggal...</p>
        </div>
        <div class="w-full max-w-md">
            <div class="text-center mb-6">
                <span class="bg-yellow-500 text-slate-900 px-4 py-1 rounded-full text-[10px] font-black uppercase tracking-widest shadow-lg">ğŸ† Duta Literasi Terajin</span>
            </div>
            <div id="podium" class="flex items-end justify-around h-48 mb-4"></div>
        </div>
        <div class="text-center animate-bounce opacity-50 font-black text-[10px] uppercase tracking-[0.3em]">Ketuk Layar Untuk Masuk ğŸ‘†</div>
    </div>
    <script>
        const firebaseConfig = { databaseURL: "https://e-perpus-a652c-default-rtdb.asia-southeast1.firebasedatabase.app" };
        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        function updateClock() {
            const now = new Date();
            document.getElementById('clock').innerText = now.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' });
            document.getElementById('date').innerText = now.toLocaleDateString('id-ID', { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' });
        }
        setInterval(updateClock, 1000); updateClock();

        db.ref('perpus_laporan').on('value', snap => {
            const counts = {};
            snap.forEach(c => { const d = c.val(); counts[d.namaSiswa] = (counts[d.namaSiswa] || 0) + 1; });
            const sorted = Object.keys(counts).map(n => ({ nama: n, total: counts[n] })).sort((a,b) => b.total - a.total).slice(0,3);
            const podiumEl = document.getElementById('podium');
            const order = [sorted[1], sorted[0], sorted[2]];
            podiumEl.innerHTML = order.map((s,i) => {
                if(!s) return `<div class="w-1/3"></div>`;
                const isFirst = s.nama === sorted[0].nama;
                return `<div class="flex flex-col items-center w-1/3 px-1">
                    <div class="glass ${isFirst ? 'h-32 shadow-yellow-500/20' : 'h-24'} w-full rounded-2xl flex flex-col items-center justify-center">
                        <span class="text-xl">${isFirst ? 'ğŸ¥‡' : (i === 0 ? 'ğŸ¥ˆ' : 'ğŸ¥‰')}</span>
                        <p class="text-[8px] font-black uppercase truncate w-full px-2 text-center">${s.nama}</p>
                        <p class="text-xl font-black">${s.total}</p>
                    </div>
                </div>`;
            }).join('');
        });
    </script>
</body>
</html>
